class SimpleRange {
  init(end) {
    this.end = end;
  }
  
  __iter__() {
    print "calling __iter__";
    return SimpleRangeIterator(this.end);
  }
}

class SimpleRangeIterator {
  init(end) {
    this.current = 0;
    this.end = end;
    print "iterator created with end: ";
    print this.end;
  }
  
  __next__() {
    print "calling __next__, current: ";
    print this.current;
    if (this.current >= this.end) {
      print "returning nil";
      return nil;
    }
    var value = this.current;
    this.current = this.current + 1;
    print "returning value: ";
    print value;
    return value;
  }
}

var r = SimpleRange(3);
print "starting foreach";
foreach (var i in r) {
  print "got: ";
  print i;
}
print "done";
